# dsc-api-address - API para consulta de endereços

API restfull para consulta de endereços do Brasil. 

Utiliza base de dados local com atualização por demanda de novos endereços junto a API do Google.

The project is generated by [LoopBack](http://loopback.io).

### Features
 * Consulta de endereços e geo localização por CEP
 * Auto atualização da base de dados local por demanda
 * Script de backup da base de dados

### Requirements
 * NodeJS >= 5
 * NPM >= 3.0
 * MongoDB >= 3.2
 * Chave de acesso Google Maps Geocoding API
 
### Dependencies
Ver arquivo package.json

## Get started
Para inicializar o ambiente de desenvolvimento(baixar dependências e inicializar base de dados) basta executar:
```shell
$ bin/init.sh
```

Para iniciar a API executar:
```shell
$ bin/start.sh
```

O endpoint da API pode ser acessado em http://127.0.0.1:3000/api

O StrongLoop API Explorer apresenta a documentação completa dos métodos da API e pode ser acessada em http://127.0.0.1:3000/explorer

### Exemplo de login:
Request:
```shell
$ curl -X POST --header "Content-Type: application/json" --header "Accept: application/json" -d "{
    \"email\": \"foo@bar.com\",
    \"password\": \"bar\"
  }" "http://127.0.0.1:3000/api/Users/login"
```
Response code 200:
```json
{
  "id": "9I2OFyIBwMgJRUvcUDJDsCZuDgL5CbzdKDmLIavPBiGPzwoQGPrb3DqFNaysflEG",
  "ttl": 1209600,
  "created": "2016-10-05T01:15:33.682Z",
  "userId": "57f046347c0d811ed3c38cdb"
}
```

### Exemplo de requisição de endereço por CEP:
Incluir na requisição o parâmetro "access_token" o token obtido no login no campo "id". Exemplo:  

Request:
```shell
$ curl -X GET --header "Accept: application/json" "http://127.0.0.1:3000/api/Addresses/cep/99074-570?access_token=9I2OFyIBwMgJRUvcUDJDsCZuDgL5CbzdKDmLIavPBiGPzwoQGPrb3DqFNaysflEG&access_token=9I2OFyIBwMgJRUvcUDJDsCZuDgL5CbzdKDmLIavPBiGPzwoQGPrb3DqFNaysflEG"
```

Response code 200:
```json
{
  "cep": "99074-570",
  "logradouro": "Rua Nossa Senhora dos Passos",
  "bairro": "Lucas Araújo",
  "localidade": "Passo Fundo",
  "uf": "RS",
  "id": "57f450b013fb499c62ab8bba",
  "geo": {
    "lat": -28.2711651,
    "lng": -52.3952349
  }
}
```

## TODO
Esta API está em desenvolvimento. Pendências:
 * Atualização automática do arquivo de BD ao encontrar novos endereços
 * Implementar backup
 * Implementar deploy
 * Implementar variáveis de ambiente

